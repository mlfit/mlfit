<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calibrate sample weights — dss • mlfit</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate sample weights — dss"><meta property="og:description" content="Calibrate sample weights according to known marginal population totals.
Based on initial sample weights, the so-called g-weights are computed
by generalized raking procedures.
The final sample weights need to be computed by multiplying the resulting
g-weights with the initial sample weights."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mlfit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1.9015</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlfit/mlfit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calibrate sample weights</h1>
    <small class="dont-index">Source: <a href="https://github.com/mlfit/mlfit/blob/main/R/grake.R" class="external-link"><code>R/grake.R</code></a></small>
    <div class="hidden name"><code>dss.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calibrate sample weights according to known marginal population totals.
Based on initial sample weights, the so-called <em>g</em>-weights are computed
by generalized raking procedures.
The final sample weights need to be computed by multiplying the resulting
<em>g</em>-weights with the initial sample weights.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dss</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">totals</span>,</span>
<span>  q <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"raking"</span>, <span class="st">"linear"</span>, <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  bounds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  ginv <span class="op">=</span> <span class="fu"><a href="gginv.html">gginv</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  attributes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a matrix of calibration variables.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>a numeric vector giving the initial sample (or design) weights.</p></dd>


<dt id="arg-totals">totals<a class="anchor" aria-label="anchor" href="#arg-totals"></a></dt>
<dd><p>a numeric vector of population totals corresponding to the
calibration variables in <code>X</code>.</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>a numeric vector of positive values accounting for
heteroscedasticity.  Small values reduce the variation of the
<em>g</em>-weights.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a character string specifying the calibration method to be
used.  Possible values are <code>"linear"</code> for the linear method,
<code>"raking"</code> for the multiplicative method known as raking and
<code>"logit"</code> for the logit method.</p></dd>


<dt id="arg-bounds">bounds<a class="anchor" aria-label="anchor" href="#arg-bounds"></a></dt>
<dd><p>a numeric vector of length two giving bounds for the g-weights
to be used in the logit method.  The first value gives the lower bound (which
must be smaller than or equal to 1) and the second value gives the upper
bound (which must be larger than or equal to 1).  If <code>NULL</code>, the
bounds are set to <code>c(0, 10)</code>.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>a numeric value giving the maximum number of iterations.</p></dd>


<dt id="arg-ginv">ginv<a class="anchor" aria-label="anchor" href="#arg-ginv"></a></dt>
<dd><p>a function that computes the Moore-Penrose generalized
inverse (default: an optimized version of <code><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">MASS::ginv()</a></code>). In
some cases it is possible to speed up the process by using
a function that computes a "regular" matrix inverse such as
<code>{solve.default}</code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>relative tolerance; convergence is achieved if the difference of
all residuals (relative to the corresponding total) is smaller than this
tolerance.</p></dd>


<dt id="arg-attributes">attributes<a class="anchor" aria-label="anchor" href="#arg-attributes"></a></dt>
<dd><p>should additional attributes (currently
<code>success</code>, <code>iterations</code>, <code>method</code> and <code>bounds</code>)
be added to the result? If <code>FALSE</code> (default), a warning is given
if convergence within the given relative tolerance could not be achieved.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A numeric vector containing the <em>g</em>-weights.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This is a faster implementation of parts of
<code><a href="https://rdrr.io/pkg/sampling/man/calib.html" class="external-link">sampling::calib()</a></code> from package <code>sampling</code>.  Note that the
default calibration method is raking and that the truncated linear method is
not yet implemented.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Deville, J.-C. and Särndal, C.-E. (1992)
Calibration estimators in survey sampling. <em>Journal of the American
Statistical Association</em>, <strong>87</strong>(418), 376–382.</p>
<p>Deville, J.-C., Särndal, C.-E. and Sautory, O. (1993)
Generalized raking procedures in survey sampling. <em>Journal of the
American Statistical Association</em>, <strong>88</strong>(423), 1013–1020.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Andreas Alfons, with improvements by Kirill Müller</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">Xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">obs</span> <span class="op">*</span> <span class="va">vars</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">/</span> <span class="va">obs</span></span></span>
<span class="r-in"><span><span class="va">totals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">vars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">dss</span><span class="op">(</span><span class="va">Xs</span>, <span class="va">d</span>, <span class="va">totals</span>, method <span class="op">=</span> <span class="st">"linear"</span>, ginv <span class="op">=</span> <span class="va">solve</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">dss</span><span class="op">(</span><span class="va">Xs</span>, <span class="va">d</span>, <span class="va">totals</span>, method <span class="op">=</span> <span class="st">"raking"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kirill Müller, Amarin Siripanich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.9000.</p>
</div>

      </footer></div>






  </body></html>

